///////////////////////////////////////////////////////////////////////
//  Copyright 2008 by WindJack Solutions, Inc.
//
//  **TERMS of USE:
// 
//  By downloading and installing this automation tool
//  from pdfscriping.com you are agreeing to the following
//  terms of use.
//
//  The code in this file is provided as a download tool
//  for paying members of pdfscripting.com. It is intended 
//  to be used as both a working tool and as a learning 
//  example.  
// 
//  By using this tool you agree to the following terms.
//  1.  You will not modify or remove this usage agreement
//  2.  You will not resell or distribute this tool for
//      profit.
//  3.  You will not distribute this tool to any person
//      or organization that is not a current member of 
//      pdfscripting.com.
//  
//  You may:
//  1. Use this tool on your own computers for any purpose you
//     desire, as long as you are the person doing it. 
//  2. Examine and modify this script for your own purposes.
//  3. Use it as an example for building your own Automation 
//     tools.  Which because they are your own, may be distributed
//     for commercial use.
//
//////////////////////////////////////////////
// 
//  ** GENERAL INSTALLATION INSTRUCTIONS:
//
//  This Acrobat Automation Script will only work when 
//  placed in one of the Acrobat JavaScript Folders. Execute
//  the following code from the Acrobat JavaScript Console to find
//  the location of the JavaScript folders. 
//
//  To display the Acrobat JavaScript Console use Ctrl+J on 
//  Windows and Command+J on the Mac
//
//      app.getPath("user","javascript");
//
//      app.getPath("app","javascript");
//
//  On Windows, the application JavaScript folder is usually located at:
//
//  C:\Program Files\Adobe\Acrobat 8.0\Acrobat\JavaScripts
//
//  On Mac, the application JavaScript folder is in a configuration file
//  inside the Acrobat Application Package.  
//
//  The script file can be placed in either the "User" or "App" JavaScript 
//  folder. 
//
//  This script will place a toolbar button on the "Add-ons" toolbar 
//  in Acrobat or Adobe Reader. If this toolbar is not visible then 
//  Right click on an empty part of the Acrobat toolbar area and select
//  "Add-ons".
//
//  JavaScript toolbar buttons were added to Acrobat in version 6. However, 
//  most automation scripts are intended to be used with Acrobat 7 or later.  
//  This particular script may contain functionality that prevents it from 
//  being used in ADobe Reader.  See comments in the JavaScript File for details.
//
///////////////////////////////////////////////////////////////////////
// Resize Pages JavaScript  Copyright (C) 2005 by Windjack Solutions, All rights reserved
//
//<AcroButtons name="Resize" version="2.0" "modified="1/27/2005 22:53:57" id="1:10:2005:21:23:2">
// This script was created by AcroButtons from Windjack Solutions, www.windjack.com
// Do not modify the code inbetween the AcroButtons Tags
// Moving or changing tag positions can compromise AcroButtons' ability to handle
// this file
// Place Extra-AcroButton Code in the following "Code Above" Section
//
///////////////////////////////////////////////////////////////////////
//
//  Resize Pages Automation Tool
// 
//  Resizes any of the Page boxes by a specified amount within a specified
//  page range.  User chooses a corner or edge of the page as an anchor point
//  then the other edges are expanded or shrunken to fit a predetermined size.
//
//  Requires Acrobat Standard or Professional, version 6 or later.
//

var blnDlgDebug = false;

// Function to round a number using the \"symmetric arithmetic\" method.
// \"factor\" (default 1) can be used to round to a specific number of decimal places.
// For example, a factor of 100 rouns to 2 decimal places.\n" +
// Algorithm adapted from http://support.microsoft.com/default.aspx?scid=kb;en-us;196652
function SymArithRound(x, factor) {
   // original VB code:  SymArith = Fix(x * factor + 0.5 * Sgn(x)) / factor
   // test and return if x = 0 to avoid problems with \"sign\" code below
   if (0 == x) { return 0; }
   // Set default value for \"factor\" if not specified.
   if ( arguments.length < 2 ) {
      var fac = 1;
   } else {
      var fac = factor;
   }
   // JavaScript has no \"sign\" function, so we need to do it ourselves.
   if (x > 0) {
      var rnd = 0.5;
   } else {
      var rnd = -0.5;
   }
   var result = Fix(x * fac + rnd) / fac;
   //console.println(\'SymArithRound: x, factor =\' + x + \', \' + fac + \', result = \' + result);
   return result;
}

function Fix(x) {
   // Returns the integer portion of real value \"x\".  JavaScript doesn\'t have this operation, either!!
   //var fixed = x - (x % 1);
   //console.println(\'Fix(\' + x + \') = \' + fixed);
   //return fixed;\n" +
   return x - (x % 1);
}

// Paper size list used in both new Doc and resize pages
var sizeListReSize =
[
{name:"LNCS",w:430,h:660}, // added by Chun Tian <binghe.lisp@gmail.com>
{name:"Letter",w:612,h:792},
{name:"Legal",w:612,h:1008},
{name:"Executive",w:522,h:756},
{name:"A0",w:2384,h:2835},
{name:"A1",w:1684,h:2384},
{name:"A2",w:1190,h:1684},
{name:"A3",w:842,h:1190},
{name:"A4",w:595,h:842},
{name:"A5",w:420,h:595},
{name:"A6",w:298,h:420},
{name:"A7",w:209,h:298},
{name:"B0",w:2384,h:4008},
{name:"B1",w:2004,h:2835},
{name:"B2",w:1417,h:2004},
{name:"B3",w:1001,h:1417},
{name:"B4",w:709,h:1001},
{name:"B5",w:499,h:709},
{name:"B6",w:354,h:499},
{name:"B7",w:249,h:354},
{name:"B8",w:176,h:249},
{name:"B9",w:125,h:176},
{name:"B10",w:88,h:125},
{name:"C2",w:1837,h:1298},
{name:"C3",w:578,h:919},
{name:"C4",w:919,h:649},
{name:"C5",w:649,h:459},
{name:"C6",w:459,h:323}
];


//<CodeAbove>
function DoResize(theDoc,fromPage,toPage,doEven,doOdd,h,w,tmb,lcr,boxes)
{
   var i, inc=0, blnEvenPage;
   var ibox, boxType, obox, ollx, olly, ourx, oury;
   var nbox = new Array(3);

   app.thermometer.duration = toPage - fromPage;
   app.thermometer.begin();
  
   for (i = fromPage; i <= toPage; i++) {
      if(app.thermometer.cancelled) break;
  
			app.thermometer.value =  ++inc;
			app.thermometer.text = "Page: " + inc.toString();

      blnEvenPage = (i % 2) != 0;   // note reversed test!
      if ( (blnEvenPage && doEven) || (! blnEvenPage && doOdd) ) {
         if (blnDlgDebug) {console.println('processing actual page ' + (i+1));}
         // Calculate the new coordinates based on the anchor position
         for (ibox = 0; ibox < boxes.length; ibox++) {
            boxType = boxes[ibox];
            if (blnDlgDebug) {console.println('  processing box ' + ibox + ', Type ' + boxType);}
            obox = theDoc.getPageBox({cBox: boxType, nPage: i});
            // normalize the page box (the PDF reference says we'd better do this)
            ollx = Math.min (obox[0], obox[2]);
            olly = Math.min (obox[1], obox[3]);
            ourx = Math.max (obox[0], obox[2]);
            oury = Math.max (obox[1], obox[3]);
            if (blnDlgDebug) {console.println('  obox= ' + ollx + ', ' + olly + ', ' + ourx + ', ' + oury);}
            switch (tmb) {
               case 'T':
                  nbox[1] = oury - h;
                  nbox[3] = oury;
                  break;
               case 'M':
                  nbox[1] = (olly + oury - h)/2;
                  nbox[3] = (olly + oury + h)/2;
                  break;
               case 'B':
                  nbox[1] = olly;
                  nbox[3] = olly + h;
                  break;
            }
            switch (lcr) {
               case 'L':
                  nbox[0] = ollx;
                  nbox[2] = ollx + w;
                  break;
               case 'C':
                  nbox[0] = (ollx + ourx - w)/2;
                  nbox[2] = (ollx + ourx + w)/2;
                  break;
               case 'R':
                  nbox[0] = ourx - w;
                  nbox[2] = ourx;
                  break;
            }
            if (blnDlgDebug) {console.println('  nbox= ' + nbox[0] + ', ' + nbox[1] + ', ' + nbox[2] + ', ' + nbox[3]);}
            // Now round the new coordinates.
            for (var j=0; j<3; j++) {
               nbox[j] = SymArithRound(nbox[j], 10000);
            }
            if (blnDlgDebug) {console.println('  rounded nbox= ' + nbox[0] + ', ' + nbox[1] + ', ' + nbox[2] + ', ' + nbox[3]);}
            // Now we actually resize the page!
            obox = theDoc.setPageBoxes({cBox: boxType, nStart: i, nEnd: i, rBox: nbox});
         } // end for each box type
      } // end if page should be processed
   } // end for each page
   app.thermometer.end();
}


var m_bLastMult = 1;
var m_numPages;
var m_pageNum;
var dlgValues = {w:0, h:0, units:1, anchor:"", range:"", fromPage:0, toPage:0, oddeven:"", boxes:""};
		
var strBlankButImg = 
"FFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFF" +
"FFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFF808080" +
"FFFDFFFFFFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0" +
"FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000" +
"FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF004040" +
"FFFDFFFFFF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040" +
"FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040";
var oIconBlank = {count: 0, width: 20, height: 20,
read: function(nBytes){return strBlankButImg.slice(this.count, this.count += nBytes);},
getIcon: function(){this.count=0;return this;}};
var  strRightButImg = 
"FFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFF" +
"FFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFF808080" +
"FFFDFFFFFFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0" +
"FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFF" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFF" +
"FF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFF" +
"FF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFF" +
"FF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFF" +
"FF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFF" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000" +
"FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF004040" +
"FFFDFFFFFF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040" +
"FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040";
var oIconRight = {count: 0, width: 20, height: 20,
read: function(nBytes){return strRightButImg.slice(this.count, this.count += nBytes);},
getIcon: function(){this.count=0;return this;}};
var strAnchorButImg = 
"FFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFF" +
"FFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFF808080" +
"FFFDFFFFFFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0" +
"FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFF" +
"FF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFF" +
"FF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000" +
"FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF004040" +
"FFFDFFFFFF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040" +
"FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040";
var oIconAnchor = {count: 0, width: 20, height: 20,
read: function(nBytes){return strAnchorButImg.slice(this.count, this.count += nBytes);},
getIcon: function(){this.count=0;return this;}};

var strLeftButImg = 
"FFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFF" +
"FFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFF808080" +
"FFFDFFFFFFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0" +
"FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFF" +
"FF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFF" +
"FF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFF" +
"FF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFF" +
"FF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000" +
"FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF004040" +
"FFFDFFFFFF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040" +
"FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040";
var oIconLeft = {count: 0, width: 20, height: 20,
read: function(nBytes){return strLeftButImg.slice(this.count, this.count += nBytes);},
getIcon: function(){this.count=0;return this;}};

var  strTopButImg = 
"FFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFF" +
"FFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFF808080" +
"FFFDFFFFFFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0" +
"FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFF" +
"FF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000" +
"FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF004040" +
"FFFDFFFFFF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040" +
"FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040";
var oIconTop = {count: 0, width: 20, height: 20,
read: function(nBytes){return strTopButImg.slice(this.count, this.count += nBytes);},
getIcon: function(){this.count=0;return this;}};

var  strBottomButImg = 
"FFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFF" +
"FFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFF808080" +
"FFFDFFFFFFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0" +
"FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFF" +
"FF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000" +
"FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF004040" +
"FFFDFFFFFF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040" +
"FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040";
var oIconBottom = {count: 0, width: 20, height: 20,
read: function(nBytes){return strBottomButImg.slice(this.count, this.count += nBytes);},
getIcon: function(){this.count=0;return this;}};

var  strSEButImg = 
"FFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFF" +
"FFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFF808080" +
"FFFDFFFFFFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0" +
"FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080" +
"FF808080FF808080FF808080FF00FFFFFF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080" +
"FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF808080FF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000" +
"FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF004040" +
"FFFDFFFFFF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040" +
"FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040";
var oIconSE = {count: 0, width: 20, height: 20,
read: function(nBytes){return strSEButImg.slice(this.count, this.count += nBytes);},
getIcon: function(){this.count=0;return this;}};

var  strSWButImg = 
"FFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFF" +
"FFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFF808080" +
"FFFDFFFFFFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0" +
"FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF00FFFFFF808080FF808080FF808080" +
"FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF808080FF808080" +
"FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF808080FF808080" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF808080FF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000" +
"FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF004040" +
"FFFDFFFFFF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040" +
"FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040";
var oIconSW = {count: 0, width: 20, height: 20,
read: function(nBytes){return strSWButImg.slice(this.count, this.count += nBytes);},
getIcon: function(){this.count=0;return this;}};

var  strNEButImg = 
"FFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFF" +
"FFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFF808080" +
"FFFDFFFFFFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0" +
"FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF808080FF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080" +
"FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080" +
"FF808080FF808080FF808080FF00FFFFFF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000" +
"FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF004040" +
"FFFDFFFFFF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040" +
"FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040";
var oIconNE = {count: 0, width: 20, height: 20,
read: function(nBytes){return strNEButImg.slice(this.count, this.count += nBytes);},
getIcon: function(){this.count=0;return this;}};

var  strNWButImg = 
"FFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFF" +
"FFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFFFDFFFFFF808080" +
"FFFDFFFFFFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0" +
"FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FFBEC0C0FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF808080FF00FFFF" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF808080FF808080" +
"FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF808080FF808080" +
"FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF00FFFFFF808080FF808080FF808080" +
"FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF00FFFFFF00FFFFFF00FFFFFF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080" +
"FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF808080FF000000FF004040" +
"FFFDFFFFFFBEC0C0FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000" +
"FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF004040" +
"FFFDFFFFFF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040" +
"FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040FF004040";
var oIconNW = {count: 0, width: 20, height: 20,
read: function(nBytes){return strNWButImg.slice(this.count, this.count += nBytes);},
getIcon: function(){this.count=0;return this;}};

// This array holds the document names and sizes for the 'psiz' control.
// The initial value is set below.
var oPsizInit =  {
	"Custom": -1,
	"LNCS": -1, // added by Chun Tian
	"Letter": -1,
	"Legal": -2,
	"Executive": -3,
	"A0": -2,
	"A1": -3,
	"A2": -4,
	"A3": -5,
	"A4": -6,
	"A5": -7,
	"A6": -8,
	"A7": -9,
	"B0": -9,
	"B1": -9,
	"B2": -9,
	"B3": -9,
	"B4": -9,
	"B5": -9,
	"B6": -9,
	"B7": -9,
	"B8": -1,
	"B9": -1,
	"B10": -1,
	"C2": -1,
	"C3": -1,
	"C4": -1,
	"C5": -1,
	"C6": -1,
};


// debug flag for the button code.
var blnDebug = false;

// debug flag for the dialog box.  Note sure why this needs to be both
// here and in the "code above" for the button.
var blnDlgDebug = false;

// ------------ beginning of dialog box code -------------
var ResizePageDlg =
{
    oDoc:null,
    nActiveAnchor: 4,
    initialize: function(dialog)
    {
		// Get page # and # of pages for use later.
		m_numPages = this.oDoc.numPages;
		m_pageNum = this.oDoc.pageNum;   // use in real environment
		this.nActiveAnchor = 4;

		dialog.load(
		{
		  "ckMe": true,
		  "ckCr": true,
		  "pEvn": 
		  {
			"All Pages": 1,
			"Odd Pages Only": -2,
			"Even Pages Only": -3,
		  },
		  "rAll": true,
		  "Rad1": true,
		  "sOfN": 'of ' + this.oDoc.numPages.toString(),
		  "tFPg": (this.oDoc.pageNum+1).toString(),
		  "tTPg": this.oDoc.numPages.toString()
		});
		

		// Set up the size fields.  Use the width and height of the current page's crop box
		// as the intial values.  See if these match any of the choices in the 'psiz' list,
		// and if they do, select that choice as the initial choice.  Otherwise select "custom".
		// First, get the current page size.  There's no guaranee that the coords are ll, ur.
		//--------test setup--------//
		var obox = this.oDoc.getPageBox({cBox: 'Crop', nPage: m_pageNum});   // use in real environment
		var curw = obox[2] - obox[0];
		var curh = obox[1] - obox[3];
		
		// now see if it's in the psiz list
		var bFound = false;
		for(var entry in sizeListReSize) 
		{
			if ( (sizeListReSize[entry]['w'] == curw) && (sizeListReSize[entry]['h'] == curh) ) 
			{
				if (blnDlgDebug) {console.println('have sizeListReSize match on ' + sizeListReSize[entry]['name']);}
				oPsizInit[sizeListReSize[entry]['name']] = 1;
				bFound = true;
				break;
			}
		}
		if ( ! bFound ) 
		{
			if (blnDlgDebug) {console.println('no size match, setting size to Custom.');}
			oPsizInit['Custom'] = 1;
			m_bLastMult = 1;
		}


		try{
		dialog.load({ "A_TL":oIconNW.getIcon(),  "A_TC":oIconTop.getIcon(),"A_TR":oIconNE.getIcon(),
					"A_ML":oIconLeft.getIcon(),"A_MC":oIconAnchor.getIcon(),"A_MR":oIconRight.getIcon(),
					"A_BL":oIconSW.getIcon(), "A_BC":oIconBottom.getIcon(), "A_BR":oIconSE.getIcon(),
					'wdth': curw, 'hght': curh,
					'psiz': oPsizInit});
		}catch(e){console.println(e);}

		dialog.enable({"tTPg": false,"tFPg": false,
						"hght":!bFound, "wdth":!bFound,
		});



    },
    validate: function(dialog)
    {
		var rslt = dialog.store();
		var strErr = "";
		// decode the psiz value.
		var psiz;
		for(var entry in rslt["psiz"]) {
		   if (rslt["psiz"][entry]> 0) {
			  psiz = entry;
			  break;
		   }
		}
		if ("Custom" == psiz) {
		   // validate the height and width.
		   var hght = rslt["hght"];
		   if (hght.match(/[^0-9\.]/) != null) {
			  strErr += "The page height is not numeric.\n";
		   } else {
			  if (hght <= 0) {
				 strErr += "The page height must be greater than zero.\n";
			  }
		   }
		   var wdth = rslt["wdth"];
		   if (wdth.match(/[^0-9\.]/) != null) {
			  strErr += "The page width is not numeric.\n";
		   } else {
			  if (wdth <= 0) {
				 strErr += "The page width must be greater than zero.\n";
			  }
		   }
		}
		if (rslt["rFro"] > 0) {
		   // validate the starting and ending page numbers.
		   var tFPg = rslt["tFPg"];
		   if (tFPg.match(/\D/) != null) {
			  strErr += "The 'from' page number is not numeric.\n";
		   } else {
			  if ( ( tFPg > m_numPages) || (tFPg <= 0) ) {
				 strErr += "The 'from' page number is out of range.\n";
			  }
		   }
		   var tTPg = rslt["tTPg"];
		   if (tTPg.match(/\D/) != null) {
			  strErr += "The 'to' page number is not numeric.\n";
		   } else {
			  if ( (tTPg > m_numPages) || (tTPg <= 0) ) {
				 strErr += "The 'to' page number is out of range.\n";
			  }
		   }
		   if (tFPg > tTPg) {
			  strErr += "The 'from' page number is larger than the 'to' page number.\n";
		   }
		}
		// make sure at least one "apply to" box is checked.
		if ( ! ( rslt["ckAr"] || rslt["ckBl"] || rslt["ckCr"] || rslt["ckMe"] || rslt["ckTr"] ) ) {
		   strErr += "At least one 'apply to' box must be selected.\n";
		}
		if (strErr != "") {
		   app.alert(strErr);
		   return(false);
		}
		return(true);
    },
    commit: function(dialog)
    {
		try{
		var rslt = dialog.store();
		dlgValues.h = rslt["hght"];
		dlgValues.w = rslt["wdth"];
		dlgValues.units = m_bLastMult;
		}catch(e){console.println(e);}
		var an;
		switch(this.nActiveAnchor)
		{
		   case 0:
			   an = "TL";
			  break;
		   case 1:
			   an = "TC";
			  break;
		   case 2:
			   an = "TR";
			  break;
		   case 3:
			   an = "ML";
			  break;
		   case 4:
			   an = "MC";
			  break;
		   case 5:
			   an = "MR";
			  break;
		   case 6:
			   an = "BL";
			  break;
		   case 7:
			   an = "BC";
			  break;
		   case 8:
			   an = "BR";
			  break;
		}

		dlgValues.anchor = an;
		var ra;
		if (rslt["rAll"]) {ra = "all"};
		if (rslt["rCur"]) {ra = "current"};
		if (rslt["rFro"]) {
		   ra = "range";
		   dlgValues.fromPage = rslt["tFPg"];
		   dlgValues.toPage = rslt["tTPg"];
		};
		dlgValues.range = ra;
		var arBx = new Array();
		if (rslt["ckAr"]) {arBx.push("Art")};
		if (rslt["ckBl"]) {arBx.push("Bleed")};
		if (rslt["ckCr"]) {arBx.push("Crop")};
		if (rslt["ckMe"]) {arBx.push("Media")};
		if (rslt["ckTr"]) {arBx.push("Trim")};
		dlgValues.boxes =arBx;
		//console.println("type of evenodd is " + typeof(rslt["pEvn"]));
		for (var i in rslt["pEvn"]) {
		   //console.println("i=" + i + ", val=" + rslt["pEvn"][i]);
		   if (rslt["pEvn"][i] > 0) {
			  dlgValues.oddeven = i;
			  break;
		   }
		}

		if (blnDlgDebug) {
		   console.println("\nThe envelope, please...");
		   for (fld in dlgValues) {
			  console.println(fld + ": " + dlgValues[fld]);
		   }
		}
    },
    "A_TL": function(dialog)
     {
          this.nActiveAnchor = 0;
		  console.println("Top Left");
      try{
      dialog.load({ "A_TL":oIconAnchor.getIcon(),  "A_TC":oIconRight.getIcon() });
      dialog.load({ "A_TR":oIconBlank.getIcon() });

      dialog.load({ "A_ML":oIconBottom.getIcon(),"A_MC":oIconSE.getIcon()});
      dialog.load({ "A_MR":oIconBlank.getIcon() });

      dialog.load({ "A_BL":oIconBlank.getIcon()});
      dialog.load({ "A_BC":oIconBlank.getIcon() });
      dialog.load({ "A_BR":oIconBlank.getIcon() });
      }catch(e){console.println(e);}

     },
    "A_TC": function(dialog)
     {
          this.nActiveAnchor = 1;
          if(app.viewerVersion < 7){
          dialog.enable({"A_TL":false,"A_TC":false,"A_TR":false,
                         "A_ML":false,"A_MC":false,"A_MR":false,
                         "A_BL":false,"A_BC":false,"A_BR":false});
          dialog.enable({"A_TL":true,"A_TR":true,
                         "A_ML":true,"A_MC":true,"A_MR":true,
                         "A_BL":true,"A_BC":true,"A_BR":true});
         }
      try{
      dialog.load({ "A_TL":oIconLeft.getIcon(),  "A_TC":oIconAnchor.getIcon() });
      dialog.load({ "A_TR":oIconRight.getIcon() });

      dialog.load({ "A_ML":oIconSW.getIcon(),"A_MC":oIconBottom.getIcon()});
      dialog.load({ "A_MR":oIconSE.getIcon() });

      dialog.load({ "A_BL":oIconBlank.getIcon()});
      dialog.load({ "A_BC":oIconBlank.getIcon() });
      dialog.load({ "A_BR":oIconBlank.getIcon() });
      }catch(e){console.println(e);}
     },
    "A_TR": function(dialog)
     {
          this.nActiveAnchor = 2;
          if(app.viewerVersion < 7){
          dialog.enable({"A_TL":false,"A_TC":false,"A_TR":false,
                         "A_ML":false,"A_MC":false,"A_MR":false,
                         "A_BL":false,"A_BC":false,"A_BR":false});
          dialog.enable({"A_TL":true,"A_TC":true,
                         "A_ML":true,"A_MC":true,"A_MR":true,
                         "A_BL":true,"A_BC":true,"A_BR":true});
         }
      try{
      dialog.load({ "A_TL":oIconBlank.getIcon(),  "A_TC":oIconLeft.getIcon() });
      dialog.load({ "A_TR":oIconAnchor.getIcon() });

      dialog.load({ "A_ML":oIconBlank.getIcon()});
      dialog.load({ "A_MC":oIconSW.getIcon()});
      dialog.load({ "A_MR":oIconBottom.getIcon() });

      dialog.load({ "A_BL":oIconBlank.getIcon()});
      dialog.load({ "A_BC":oIconBlank.getIcon() });
      dialog.load({ "A_BR":oIconBlank.getIcon() });
      }catch(e){console.println(e);}
     },
    "A_ML": function(dialog)
     {
          this.nActiveAnchor = 3;
          if(app.viewerVersion < 7){
          dialog.enable({"A_TL":false,"A_TC":false,"A_TR":false,
                         "A_ML":false,"A_MC":false,"A_MR":false,
                         "A_BL":false,"A_BC":false,"A_BR":false});
          dialog.enable({"A_TL":true,"A_TC":true,"A_TR":true,
                         "A_MC":true,"A_MR":true,
                         "A_BL":true,"A_BC":true,"A_BR":true});
         }
      try{
      dialog.load({ "A_TL":oIconTop.getIcon(),  "A_TC":oIconNE.getIcon() });
      dialog.load({ "A_TR":oIconBlank.getIcon() });

      dialog.load({ "A_ML":oIconAnchor.getIcon(),"A_MC":oIconRight.getIcon()});
      dialog.load({ "A_MR":oIconBlank.getIcon() });

      dialog.load({ "A_BL":oIconBottom.getIcon()});
      dialog.load({ "A_BC":oIconSE.getIcon() });
      dialog.load({ "A_BR":oIconBlank.getIcon() });
      }catch(e){console.println(e);}

     },
    "A_MC": function(dialog)
     {
          this.nActiveAnchor = 4;
          if(app.viewerVersion < 7){
          dialog.enable({"A_TL":false,"A_TC":false,"A_TR":false,
                         "A_ML":false,"A_MC":false,"A_MR":false,
                         "A_BL":false,"A_BC":false,"A_BR":false});
          dialog.enable({"A_TL":true,"A_TC":true,"A_TR":true,
                         "A_ML":true,"A_MR":true,
                         "A_BL":true,"A_BC":true,"A_BR":true});
         }
      try{
      dialog.load({ "A_TL":oIconNW.getIcon(),  "A_TC":oIconTop.getIcon() });
      dialog.load({ "A_TR":oIconNE.getIcon() });
      dialog.load({ "A_ML":oIconLeft.getIcon(),"A_MC":oIconAnchor.getIcon(),"A_MR":oIconRight.getIcon() });
      dialog.load({ "A_BL":oIconSW.getIcon(), "A_BC":oIconBottom.getIcon() });
      dialog.load({ "A_BR":oIconSE.getIcon() });
      }catch(e){console.println(e);}
     },
    "A_MR": function(dialog)
     {
          this.nActiveAnchor = 5;
          if(app.viewerVersion < 7){
          dialog.enable({"A_TL":false,"A_TC":false,"A_TR":false,
                         "A_ML":false,"A_MC":false,"A_MR":false,
                         "A_BL":false,"A_BC":false,"A_BR":false});
          dialog.enable({"A_TL":true,"A_TC":true,"A_TR":true,
                         "A_ML":true,"A_MC":true,
                         "A_BL":true,"A_BC":true,"A_BR":true});
         }
      try{
      dialog.load({ "A_TL":oIconBlank.getIcon()});
      dialog.load({ "A_TC":oIconNW.getIcon() });
      dialog.load({ "A_TR":oIconTop.getIcon() });

      dialog.load({ "A_ML":oIconBlank.getIcon()});
      dialog.load({ "A_MC":oIconLeft.getIcon()});
      dialog.load({ "A_MR":oIconAnchor.getIcon() });

      dialog.load({ "A_BL":oIconBlank.getIcon()});
      dialog.load({ "A_BC":oIconSW.getIcon() });
      dialog.load({ "A_BR":oIconBottom.getIcon() });
      }catch(e){console.println(e);}
     },
    "A_BL": function(dialog)
     {
          this.nActiveAnchor = 6;
          if(app.viewerVersion < 7){
          dialog.enable({"A_TL":false,"A_TC":false,"A_TR":false,
                         "A_ML":false,"A_MC":false,"A_MR":false,
                         "A_BL":false,"A_BC":false,"A_BR":false});
          dialog.enable({"A_TL":true,"A_TC":true,"A_TR":true,
                         "A_ML":true,"A_MC":true,"A_MR":true,
                         "A_BC":true,"A_BR":true});
         }
      try{
      dialog.load({ "A_TL":oIconBlank.getIcon()});
      dialog.load({ "A_TC":oIconBlank.getIcon() });
      dialog.load({ "A_TR":oIconBlank.getIcon() });

      dialog.load({ "A_ML":oIconTop.getIcon(),"A_MC":oIconNE.getIcon()});
      dialog.load({ "A_MR":oIconBlank.getIcon() });

      dialog.load({ "A_BL":oIconAnchor.getIcon()});
      dialog.load({ "A_BC":oIconRight.getIcon() });
      dialog.load({ "A_BR":oIconBlank.getIcon() });
      }catch(e){console.println(e);}

     },
   "A_BC": function(dialog)
     {
          this.nActiveAnchor = 7;
          if(app.viewerVersion < 7){
          dialog.enable({"A_TL":false,"A_TC":false,"A_TR":false,
                         "A_ML":false,"A_MC":false,"A_MR":false,
                         "A_BL":false,"A_BC":false,"A_BR":false});
          dialog.enable({"A_TL":true,"A_TC":true,"A_TR":true,
                         "A_ML":true,"A_MC":true,"A_MR":true,
                         "A_BL":true,"A_BR":true});
         }
      try{
      dialog.load({ "A_TL":oIconBlank.getIcon()});
      dialog.load({ "A_TC":oIconBlank.getIcon() });
      dialog.load({ "A_TR":oIconBlank.getIcon() });

      dialog.load({ "A_ML":oIconNW.getIcon(),"A_MC":oIconTop.getIcon(),"A_MR":oIconNE.getIcon() });
      dialog.load({ "A_BL":oIconLeft.getIcon(), "A_BC":oIconAnchor.getIcon() });
      dialog.load({ "A_BR":oIconRight.getIcon() });
      }catch(e){console.println(e);}
     },
    "A_BR": function(dialog)
     {
          this.nActiveAnchor = 8;
          if(app.viewerVersion < 7){
          dialog.enable({"A_TL":false,"A_TC":false,"A_TR":false,
                         "A_ML":false,"A_MC":false,"A_MR":false,
                         "A_BL":false,"A_BC":false,"A_BR":false});
          dialog.enable({"A_TL":true,"A_TC":true,"A_TR":true,
                         "A_ML":true,"A_MC":true,"A_MR":true,
                         "A_BL":true,"A_BC":true});
         }
      try{
      dialog.load({ "A_TL":oIconBlank.getIcon()});
      dialog.load({ "A_TC":oIconBlank.getIcon() });
      dialog.load({ "A_TR":oIconBlank.getIcon() });

      dialog.load({ "A_ML":oIconBlank.getIcon()});
      dialog.load({ "A_MC":oIconNW.getIcon()});
      dialog.load({ "A_MR":oIconTop.getIcon() });

      dialog.load({ "A_BL":oIconBlank.getIcon()});
      dialog.load({ "A_BC":oIconLeft.getIcon() });
      dialog.load({ "A_BR":oIconAnchor.getIcon() });
      }catch(e){console.println(e);}
     },
    "tFPg": function(dialog)
    {


    },
    "rFro": function(dialog)
    {
dialog.enable({"tFPg":true ,"tTPg":true});
    },
    "rCur": function(dialog)
    {
dialog.enable({"tFPg":false ,"tTPg":false});
    },
    "rAll": function(dialog)
    {
dialog.enable({"tFPg":false ,"tTPg":false});
    },
    "Rad3": function(dialog)
    {
this["psiz"](dialog);
    },
    "Rad2": function(dialog)
    {
this["psiz"](dialog);
    },
    "Rad1": function(dialog)
    {
this["psiz"](dialog);
    },
    "psiz": function(dialog)
    {

			var rslts = dialog.store();
			var sel ="";
			for(var entry in rslts["psiz"])
			{
					if(rslts["psiz"][entry]> 0)
				 {
							 sel = entry;
								break;
				 }
			}
			 var mult = 1;
			 if(rslts["Rad2"])
					 mult = 72;
			 else if(rslts["Rad3"])
					 mult = 2.835;
			 var bCustom = (sel =="Custom");
			 dialog.enable({"hght": bCustom,"wdth":bCustom});
			 var nH = 0, nW = 0;
			 if(bCustom)
			 {
							nH = (rslts["hght"] * m_bLastMult )/mult;
							nW = (rslts["wdth"] * m_bLastMult)/mult;
			 }
			 else
			 {
					var nLen = sizeListReSize.length;
					for(var i=0;i<nLen;i++)
					{
							 if(sizeListReSize[i].name == sel)
							{
									nH = sizeListReSize[i].h/mult;
									nW = sizeListReSize[i].w/mult;
									break;
							}
					}
			 }
			 dialog.load({"hght": nH,"wdth":nW});
			 m_bLastMult = mult;

    },
    description:
    {
      first_tab: "psiz",
      name: "Resize pages",
      target_id: "psiz",
      elements:
      [
        {
          alignment: "align_left",
          type: "view",
          elements:
          [
            {
              align_children: "align_top",
              type: "view",
              elements:
              [
                {
                  align_children: "align_top",
                  item_id: "cSiz",
                  name: "New size",
                  type: "cluster",
                  elements:
                  [
                    {
                      align_children: "align_top",
                      type: "view",
                      elements:
                      [
                        {
                          item_id: "V2",
                          type: "view",
                          elements:
                          [
                            {
                              alignment: "align_left",
                              height: 23,
                              item_id: "psiz",
                              next_tab: "hght",
                              type: "popup",
                              width: 53,
                            },
                            {
                              align_children: "align_row",
                              item_id: "V4",
                              type: "view",
                              elements:
                              [
                                {
                                  height: 24,
                                  item_id: "sta1",
                                  name: "Width:",
                                  type: "static_text",
                                  width: 42,
                                },
                                {
                                  char_width: 8,
                                  height: 24,
                                  item_id: "wdth",
                                  next_tab: "Rad1",
                                  type: "edit_text",
                                  width: 88,
                                },
                              ]
                            },
                            {
                              align_children: "align_row",
                              item_id: "V3",
                              type: "view",
                              elements:
                              [
                                {
                                  height: 24,
                                  item_id: "sta1",
                                  name: "Height:",
                                  type: "static_text",
                                  width: 42,
                                },
                                {
                                  alignment: "align_left",
                                  char_width: 8,
                                  height: 24,
                                  item_id: "hght",
                                  next_tab: "wdth",
                                  type: "edit_text",
                                  width: 88,
                                },
                              ]
                            },
                          ]
                        },
                        {
                          align_children: "align_left",
 //                         height: 113,
                          item_id: "cUni",
                          name: "Units",
                          type: "cluster",
                          elements:
                          [
                            {
                              group_id: "Unit",
                              item_id: "Rad1",
                              name: "points",
                              next_tab: "Rad2",
                              type: "radio",
                            },
                            {
                              group_id: "Unit",
                              item_id: "Rad2",
                              name: "inches",
                              next_tab: "Rad3",
                              type: "radio",
                            },
                            {
                              group_id: "Unit",
 //                             height: 23,
                              item_id: "Rad3",
                              name: "millimeters",
                              type: "radio",
 //                             width: 88,
                            },
                          ]
                        },
                      ]
                    },
                  ]
                },
                {
                  align_children: "align_center",
                  item_id: "cAnc",
                  name: "Anchor",
                  type: "cluster",
                  elements:
                  [
                    {
                      align_children: "align_row",
                      alignment: "align_center",
                      type: "view",
                      elements:
                      [
                        {
//                          alignment: "align_distribute",
                          width: 20,
                          height: 20,
                          type: "image",
                          item_id: "A_TL",
                          next_tab: "A_TC",
                        },
                        {
//                          alignment: "align_distribute",
                          width: 20,
                          height: 20,
                          type: "image",
                          item_id: "A_TC",
                          next_tab: "A_TR",
                        },
                        {
//                          alignment: "align_distribute",
                          width: 20,
                          height: 20,
                          type: "image",
                          item_id: "A_TR",
                          next_tab: "A_ML",
                        },
                      ]
                    },
                    {
                      align_children: "align_row",
                      type: "view",
                      elements:
                      [
                        {
//                          alignment: "align_distribute",
                          width: 20,
                          height: 20,
                          type: "image",
                          item_id: "A_ML",
                          next_tab: "A_MC",
                        },
                        {
//                          alignment: "align_distribute",
                          width: 20,
                          height: 20,
                          type: "image",
                          item_id: "A_MC",
                          next_tab: "A_MR",
                        },
                        {
//                          alignment: "align_distribute",
                          width: 20,
                          height: 20,
                          type: "image",
                          item_id: "A_MR",
                          next_tab: "A_BL",
                        },
                      ]
                    },
                    {
                      align_children: "align_row",
                      type: "view",
                      elements:
                      [
                        {
//                          alignment: "align_distribute",
                          width: 20,
                          height: 20,
                          type: "image",
                          item_id: "A_BL",
                          next_tab: "A_BC",
                        },
                        {
//                          alignment: "align_distribute",
                          width: 20,
                          height: 20,
                          type: "image",
                          item_id: "A_BC",
                          next_tab: "A_BR",
                        },
                        {
//                          alignment: "align_distribute",
                          width: 20,
                          height: 20,
                          type: "image",
                          item_id: "A_BR",
                          next_tab: "rAll",
                        },
                      ]
                    },
                  ]
                },
              ]
            },
            {
              align_children: "align_top",
              type: "view",
              elements:
              [
                {
                  item_id: "cls3",
                  name: "Page range",
                  type: "cluster",
                  elements:
                  [
                    {
                      group_id: "rang",
                      item_id: "rAll",
                      name: "All",
                      next_tab: "rSel",
                      type: "radio",
                    },
                    {
                      group_id: "rang",
                      item_id: "rCur",
                      name: "Current Page",
                      next_tab: "rFro",
                      type: "radio",
                    },
                    {
                      align_children: "align_row",
                      type: "view",
                      width: 256,
                      elements:
                      [
                        {
                          group_id: "rang",
                          item_id: "rFro",
                          name: "From:",
                          next_tab: "tFPg",
                          type: "radio",
                        },
                        {
                          char_width: 6,
                          item_id: "tFPg",
                          next_tab: "tTPg",
                          type: "edit_text",
                        },
                        {
                          item_id: "sta1",
                          name: "To:",
                          type: "static_text",
                        },
                        {
                          char_width: 6,
                          item_id: "tTPg",
                          next_tab: "pEvn",
                          type: "edit_text",
                        },
                        {
                          item_id: "sOfN",
                          name: "of (N)",
                          type: "static_text",
                          width: 40,
                        },
                      ]
                    },
                    {
                      height: 5,
                      item_id: "gap1",
                      type: "gap",
                      width: 151,
                    },
                    {
                      align_children: "align_row",
                      type: "view",
                      elements:
                      [
                        {
                          item_id: "sta3",
                          name: "Resize:",
                          type: "static_text",
                        },
                        {
                          enable: "true",
                          item_id: "pEvn",
                          name: "goo",
                          next_tab: "ckAr",
                          type: "popup",
                          width: 120,
                        },
                      ]
                    },
                  ]
                },
                {
                  align_children: "align_left",
                  alignment: "align_distribute",
//                  char_height: 8,
//                  char_width: 8,
//                  height: 180,
                  item_id: "cBxs",
                  name: "Apply to",
                  type: "cluster",
//                  width: 110,
                  elements:
                  [
                    {
                      item_id: "ckAr",
                      name: "Art Box",
                      next_tab: "ckBl",
                      type: "check_box",
                    },
                    {
                      item_id: "ckBl",
                      name: "Bleed Box",
                      next_tab: "ckCr",
                      type: "check_box",
                    },
                    {
                      item_id: "ckCr",
                      name: "Crop Box",
                      next_tab: "ckMe",
                      type: "check_box",
                    },
                    {
                      item_id: "ckMe",
                      name: "Media Box",
                      next_tab: "ckTr",
                      type: "check_box",
                    },
                    {
                      item_id: "ckTr",
                      name: "Trim Box",
                      next_tab: "OK",
                      type: "check_box",
                    },
                  ]
                },
              ]
            },
            {
              align_children: "align_left",
              alignment: "align_fill",
              name: "OK",
              type: "ok_cancel",
            },
          ]
        },
      ]
    }
  };

// ------------------- end of dialog box code -------------------

var PDFS_DoResizePages = app.trustedFunction(function(oDoc)
{
	app.beginPriv();
	ResizePageDlg.oDoc = oDoc;
	if ('ok' == app.execDialog(ResizePageDlg)) 
	{
	   // Determine the starting and ending pages to process.
	   // the values set are 0-based!
	   var fromPage, toPage;
	   switch (dlgValues['range']) {
		  case 'all':
			 fromPage = 0;
			 toPage = oDoc.numPages - 1;
			 break;
		  case 'current':
			 fromPage = oDoc.pageNum;
			 toPage = oDoc.pageNum;
		  if (blnDebug) {console.println('In Current: pg:'+ toPage);}
			 break;
		  case 'range':
			 fromPage = dlgValues['fromPage'] - 1;
			 toPage = dlgValues['toPage'] - 1;
			 break;
	   }
	   if (blnDebug) {console.println('fromPage, toPage (zero-based) = ' + fromPage + ', ' + toPage);}

	   // Set even and odd page flags.
	   var doOdd, doEven;
	   switch (dlgValues['oddeven']) {
		  case 'All Pages':
			 doOdd = true;
			 doEven = true;
			 break;
		  case 'Even Pages Only':
			 doOdd = false;
			 doEven = true;
			 break;
		  case 'Odd Pages Only':
			 doOdd = true;
			 doEven = false;
			 break;
	   }
	   if (blnDebug) {console.println('doOdd, doEven = ' + doOdd + ', ' + doEven);}

	   // set up anchor and box variables and calc new page size in points
	   var tmb, lcr, boxes, w, h;
	   tmb = dlgValues['anchor'][0];
	   lcr = dlgValues['anchor'][1];
	   w = dlgValues['w'] * dlgValues['units'];
	   h = dlgValues['h'] * dlgValues['units'];
	   if (blnDebug) {console.println('tmb, lcr, w, h = ' + tmb + ', ' + lcr + ', ' + w + ', ' + h);}
	   boxes = dlgValues['boxes'];

	   DoResize(oDoc,fromPage,toPage,doEven,doOdd,h,w,tmb,lcr,boxes);
	} // end if OK was pressed
	app.endPriv();
});



var strIconDataResize = 
"FF4040B7FF4040B7FF4040B7FF4040B7FF4040B7FF4040B7FF4040B7FF4040B7FF4040B7FF4040B7" +
"FFABABE200C0C0C000C0C0C000C0C0C000C0C0C0FF4040B7FFB1B1E5FFB1B1E5FFB1B1E5FFB1B1E5" +
"FFB1B1E5FFB1B1E5FFB1B1E5FFB1B1E5FFB1B1E5FF4040B7FFABABE200C0C0C000C0C0C000C0C0C0" +
"FF4040B7FFB1B1E5FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFEFFFF402E00FFF5FCFFFFF1F9FF" +
"FF5FA4E1FF3F90D9FF4040B7FFABABE200C0C0C0FF4040B7FFB1B1E5FFFFFFFFFFFFFFFFFFFFFFFF" +
"FFFFFFFFFF402E00FFFFE945FF402E00FFEFF8FFFF5FA4E1FF3F90D9FF1E78CFFF4040B7FFABABE2" +
"FF4040B7FFB1B1E5FFFFFFFFFFFFFFFFFFFFFFFFFF402E00FFFFE945FFFFE945FFFFE945FF402E00" +
"FF318AD7FF207CD2FF0F6DCDFF0F6DCDFF4040B7FF4040B7FFB1B1E5FFFFFFFFFFFFFFFFFF402E00" +
"FFFFE945FFFFCB12FFFFE946FFFFFF76FFFFE945FF402E00FF4040B7FF4040B7FF4040B7FF4040B7" +
"FF4040B7FFB1B1E5FFFFFFFFFF464F54FFFFFFFFFF402E00FF544306FFFFE945FF545427FF40401D" +
"FF90A4E5FF737373FF90A4E5FF90A4E5FF687AD4FF4040B7FFB1B1E5FFFFFFFFFF402E00FF959595" +
"FF959595FF403304FFFFE945FF40401DFFDFF4FFFFB8C4CDFF616365FFC6E8FFFFBFE6FFFF687AD4" +
"FF4040B7FFB1B1E5FF402E00FFFFE945FF40401DFFB8C4CDFF403304FFFFE945FF40401DFFDCF2FF" +
"FF40401DFFFFE945FF3B3B3BFFBDE5FFFF687AD4FF4040B7FF402E00FFFFE945FFFFE945FF545427" +
"FF40401DFF40401DFFFFE945FF40401DFF40401DFF545427FFFFFF76FFFFE945FF402E00FF687AD4" +
"FF402E00FFFFE945FFFFE945FFFFE946FFFFE945FFFFE945FFFFE945FFFFE945FFFFE945FFFFE945" +
"FFFFE945FFFFE946FFFFE945FFFFE945FF402E00FF4040B7FF402E00FFFFE945FFFFCB12FF544306" +
"FF403304FF403304FFFFE945FF40401DFF403304FF544306FFFFCB12FFFFE945FF402E00FF687AD4" +
"FF4040B7FFB1B1E5FF402E00FFFFE945FF402E00FFE5F5FFFF403304FFFFE945FF40401DFFCDECFF" +
"FFC0E6FFFFFFE945FF402E00FFADDFFFFF687AD4FF4040B7FFB1B1E5FFF8FCFFFF402E00FF959595" +
"FFE2F4FFFF544306FFFFE945FF545427FF40401DFFBCE5FFFF402E00FFB1DFFFFFABDEFFFF687AD4" +
"FF4040B7FFB1B1E5FFF7FBFFFFF2F9FFFF402E00FFFFE945FFFFCB12FFFFE946FFFFFF76FFFFE945" +
"FF402E00FFB3E2FFFFADDEFFFFA8DCFFFF687AD4FF4040B7FFB1B1E5FFF4FBFFFFEFF9FFFFE8F7FF" +
"FF402E00FFFFE945FFFFE945FFFFE945FF402E00FFB7E2FFFFB1DFFFFFACDEFFFFA5DBFFFF687AD4" +
"FF4040B7FFB1B1E5FFF2F9FFFFEBF8FFFFE6F5FFFFD9F1FFFF402E00FFFFE945FF402E00FFBFE5FF" +
"FFB4E1FFFFAFDEFFFFA9DCFFFFA4DBFFFF687AD4FF4040B7FFB1B1E5FFEBF8FFFFE5F5FFFFE1F4FF" +
"FFD4EEFFFFCDEBFFFF402E00FFC0E6FFFFB9E3FFFFAFDFFFFFA8DCFFFFA3DBFFFF9FD8FFFF687AD4" +
"FF4040B7FF687AD4FF687AD4FF687AD4FF687AD4FF687AD4FF687AD4FF687AD4FF687AD4FF687AD4" +
"FF687AD4FF687AD4FF687AD4FF687AD4FF687AD4FF4040B7FF4040B7FF4040B7FF4040B7FF4040B7" +
"FF4040B7FF4040B7FF4040B7FF4040B7FF4040B7FF4040B7FF4040B7FF4040B7FF4040B7FF4040B7";

var oIconResizeTool = {count: 0, width: 15, height: 20,
read: function(nBytes){return strIconDataResize.slice(this.count, this.count += nBytes);}};


var oButObjResize = 
{cName: "PDFS_ResizePage",
cExec: "PDFS_DoResizePages(event.target);",
cEnable: "event.rc = (app.doc != null) && (app.viewerType != \"Reader\")",
cMarked: "event.rc = false",
cTooltext: "Resize the Document Page Boxes",
oIcon: oIconResizeTool,
cLabel: "Resize Pages"};

// try{app.removeToolButton("PDFS_ResizePage");}catch(e){}
try{app.addToolButton(oButObjResize);}catch(e){}


